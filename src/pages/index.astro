---
import Layout from "@/layouts/Layout.astro";
import { site } from "@/data/site.config";

const projectFiles = import.meta.glob("../content/projects/*.md", {
  eager: true,
});
const projects = Object.values(projectFiles) as any[];

const skillTags = [
  "Playwright",
  "TypeScript",
  "CI/CD",
  "API Testing",
  "Selenium",
  "Jest",
];

const icons = {
  home: `<svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"><path d="m3 9 9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"/><polyline points="9 22 9 12 15 12 15 22"/></svg>`,
  user: `<svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"><path d="M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2"/><circle cx="12" cy="7" r="4"/></svg>`,
  work: `<svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"><rect x="2" y="3" width="20" height="14" rx="2" ry="2"/><line x1="8" y1="21" x2="16" y2="21"/><line x1="12" y1="17" x2="12" y2="21"/></svg>`,
  mail: `<svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"><rect x="2" y="4" width="20" height="16" rx="2"/><path d="m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7"/></svg>`,
  sun: `<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="4"/><path d="M12 2v2"/><path d="M12 20v2"/><path d="m4.93 4.93 1.41 1.41"/><path d="m17.66 17.66 1.41 1.41"/><path d="M2 12h2"/><path d="M20 12h2"/><path d="m6.34 17.66-1.41 1.41"/><path d="m19.07 4.93-1.41 1.41"/></svg>`,
  moon: `<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M12 3a6 6 0 0 0 9 9 9 9 0 1 1-9-9Z"/></svg>`,
  github: `<svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="currentColor"><path d="M12 0c-6.626 0-12 5.373-12 12 0 5.302 3.438 9.8 8.207 11.387.599.111.793-.261.793-.577v-2.234c-3.338.726-4.033-1.416-4.033-1.416-.546-1.387-1.333-1.756-1.333-1.756-1.089-.745.083-.729.083-.729 1.205.084 1.839 1.237 1.839 1.237 1.07 1.834 2.807 1.304 3.492.997.107-.775.418-1.305.762-1.604-2.665-.305-5.467-1.334-5.467-5.931 0-1.311.469-2.381 1.236-3.221-.124-.303-.535-1.524.117-3.176 0 0 1.008-.322 3.301 1.23.957-.266 1.983-.399 3.003-.404 1.02.005 2.047.138 3.006.404 2.291-1.552 3.297-1.23 3.297-1.23.653 1.653.242 2.874.118 3.176.77.84 1.235 1.911 1.235 3.221 0 4.609-2.807 5.624-5.479 5.921.43.372.823 1.102.823 2.222v3.293c0 .319.192.694.801.576 4.765-1.589 8.199-6.086 8.199-11.386 0-6.627-5.373-12-12-12z"/></svg>`,
  linkedin: `<svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="currentColor"><path d="M20.447 20.452h-3.554v-5.569c0-1.328-.027-3.037-1.852-3.037-1.853 0-2.136 1.445-2.136 2.939v5.667H9.351V9h3.414v1.561h.046c.477-.9 1.637-1.85 3.37-1.85 3.601 0 4.267 2.37 4.267 5.455v6.286zM5.337 7.433c-1.144 0-2.063-.926-2.063-2.065 0-1.138.92-2.063 2.063-2.063 1.14 0 2.064.925 2.064 2.063 0 1.139-.925 2.065-2.064 2.065zm1.782 13.019H3.555V9h3.564v11.452zM22.225 0H1.771C.792 0 0 .774 0 1.729v20.542C0 23.227.792 24 1.771 24h20.451C23.2 24 24 23.227 24 22.271V1.729C24 .774 23.2 0 22.222 0h.003z"/></svg>`,
  twitter: `<svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="currentColor"><path d="M18.244 2.25h3.308l-7.227 8.26 8.502 11.24H16.17l-5.214-6.817L4.99 21.75H1.68l7.73-8.835L1.254 2.25H8.08l4.713 6.231zm-1.161 17.52h1.833L7.084 4.126H5.117z"/></svg>`,
  arrow: `<svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M7 7h10v10"/><path d="M7 17 17 7"/></svg>`,
};
---

<Layout>
  <div class="scroll-progress" id="scroll-progress" aria-hidden="true"></div>
  <div class="custom-cursor" id="custom-cursor" aria-hidden="true"></div>

  <!-- Floating Dock -->
  <nav class="floating-dock" id="floating-dock" aria-label="Page navigation">
    <a href="#" class="dock-btn active" data-section="hero" aria-label="Home">
      <Fragment set:html={icons.home} />
    </a>
    <a href="#about" class="dock-btn" data-section="about" aria-label="About">
      <Fragment set:html={icons.user} />
    </a>
    <a href="#work" class="dock-btn" data-section="work" aria-label="Work">
      <Fragment set:html={icons.work} />
    </a>
    <a
      href="#contact"
      class="dock-btn"
      data-section="contact"
      aria-label="Contact"
    >
      <Fragment set:html={icons.mail} />
    </a>
    <div class="dock-divider" aria-hidden="true"></div>
    <button class="dock-btn" id="theme-toggle" aria-label="Toggle theme">
      <span class="dark:hidden" set:html={icons.sun}></span>
      <span class="hidden dark:block" set:html={icons.moon}></span>
    </button>
  </nav>

  <main class="w-full max-w-[624px] mx-auto px-6">
    <!-- Hero -->
    <section id="hero" class="relative pt-16 pb-6 md:pt-20 md:pb-8">
      <div class="hero-geometric hero-geometric--circle" aria-hidden="true">
      </div>
      <div class="hero-geometric hero-geometric--line" aria-hidden="true"></div>

      <div class="w-full text-left">
        <h1
          class="text-[40px] md:text-[48px] font-extrabold leading-[1.05] tracking-[-0.03em] mb-4 text-gradient fade-in fade-in-delay-1"
        >
          hi, i'm {site.author.toLowerCase()}
        </h1>
        <p
          class="text-[15px] leading-[1.75] text-[var(--foreground-secondary)] max-w-[480px] mb-4 fade-in fade-in-delay-3"
        >
          A QA Engineer with 1 year of experience. I love breaking things and
          helping teams ship quality software. Very active on <a
            href="https://github.com/theodores"
            class="link-sophisticated"
            target="_blank"
            rel="noopener noreferrer">GitHub</a
          >.
        </p>
        <div class="currently-indicator fade-in fade-in-delay-4">
          <span>Currently: Building test automation at</span>
          <a href="#work">GoTo Financial</a>
          <span set:html={icons.arrow}></span>
        </div>
      </div>
    </section>

    <!-- About -->
    <section id="about" class="pt-0 pb-10 scroll-reveal">
      <span class="section-heading mb-5 block">About</span>
      <div
        class="space-y-4 text-[15px] leading-[1.8] text-[var(--foreground-secondary)]"
      >
        <p>
          At the start of 2023, I began my journey into QA and test automation.
          In the past, I <a href="#" class="link-sophisticated"
            >learned automated testing fundamentals</a
          >, <a href="#" class="link-sophisticated"
            >interned at a tech company</a
          >, and <a href="#" class="link-sophisticated"
            >built several testing projects</a
          >.
        </p>
        <p>
          I specialize in Playwright and TypeScript for end-to-end testing. My
          approach combines technical curiosity with pragmatism—I'm always eager
          to learn and improve my craft.
        </p>
      </div>

      <!-- Skill Tags -->
      <div class="flex flex-wrap gap-1.5 mt-6">
        {skillTags.map((skill) => <span class="skill-tag">{skill}</span>)}
      </div>
    </section>

    <!-- Bento Grid — Monochrome -->
    <section class="py-10 scroll-reveal">
      <div class="grid grid-cols-3 gap-2.5">
        <div class="bento-cell bg-[#141414]">
          <svg
            class="w-6 h-6 text-white/80 relative z-10"
            viewBox="0 0 24 24"
            fill="none"
            stroke="currentColor"
            stroke-width="1.5"
          >
            <polyline points="22 12 18 12 15 21 9 3 6 12 2 12"></polyline>
          </svg>
        </div>
        <div class="bento-cell bg-[#2A2A2A]">
          <svg
            class="w-6 h-6 text-white/80 relative z-10"
            viewBox="0 0 24 24"
            fill="none"
            stroke="currentColor"
            stroke-width="1.5"
          >
            <rect x="2" y="3" width="20" height="14" rx="2"></rect>
            <line x1="8" y1="21" x2="16" y2="21"></line>
            <line x1="12" y1="17" x2="12" y2="21"></line>
          </svg>
        </div>
        <div class="bento-cell bg-[#1A1A1A]">
          <svg
            class="w-6 h-6 text-white/80 relative z-10"
            viewBox="0 0 24 24"
            fill="none"
            stroke="currentColor"
            stroke-width="1.5"
          >
            <path d="M12 2L2 7l10 5 10-5-10-5z"></path>
            <path d="M2 17l10 5 10-5"></path>
            <path d="M2 12l10 5 10-5"></path>
          </svg>
        </div>
        <div class="bento-cell bg-[#333]">
          <svg
            class="w-6 h-6 text-white/80 relative z-10"
            viewBox="0 0 24 24"
            fill="none"
            stroke="currentColor"
            stroke-width="1.5"
          >
            <circle cx="12" cy="12" r="10"></circle>
            <path d="M12 6v6l4 2"></path>
          </svg>
        </div>
        <div class="bento-cell bg-[#181818]">
          <svg
            class="w-6 h-6 text-white/80 relative z-10"
            viewBox="0 0 24 24"
            fill="none"
            stroke="currentColor"
            stroke-width="1.5"
          >
            <path
              d="M21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16z"
            ></path>
          </svg>
        </div>
        <div class="bento-cell bg-[#252525]">
          <svg
            class="w-6 h-6 text-white/80 relative z-10"
            viewBox="0 0 24 24"
            fill="none"
            stroke="currentColor"
            stroke-width="1.5"
          >
            <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"
            ></path>
            <polyline points="14 2 14 8 20 8"></polyline>
            <line x1="16" y1="13" x2="8" y2="13"></line>
            <line x1="16" y1="17" x2="8" y2="17"></line>
          </svg>
        </div>
      </div>
    </section>

    <!-- Projects -->
    <section id="work" class="py-10 scroll-reveal">
      <div class="text-center mb-8">
        <span class="section-heading mb-3 inline-block">Projects</span>
        <h2
          class="text-[28px] md:text-[34px] font-extrabold mb-2 tracking-[-0.02em] leading-[1.1]"
        >
          i like to break things
        </h2>
        <p
          class="text-[13px] text-[var(--foreground-muted)] max-w-sm mx-auto leading-[1.7]"
        >
          Testing projects from automation frameworks to API testing tools. Here
          are a few favorites.
        </p>
      </div>

      <div class="space-y-1.5">
        {
          projects.map((project) => (
            <a
              href={project.frontmatter.links?.[0]?.url || "#"}
              class="project-card"
              target="_blank"
              rel="noopener noreferrer"
            >
              <div class="flex justify-between items-start gap-4 mb-1.5">
                <h3 class="text-[15px] font-semibold project-title">
                  {project.frontmatter.title}
                </h3>
                <span class="text-[10px] text-[var(--foreground-muted)] font-mono shrink-0 mt-0.5">
                  {project.frontmatter.period}
                </span>
              </div>
              <p class="text-[13px] text-[var(--foreground-muted)] leading-[1.6] mb-2">
                {project.frontmatter.description}
              </p>
              <div class="flex flex-wrap gap-1">
                {project.frontmatter.tech.slice(0, 4).map((tech: string) => (
                  <span class="text-[10px] font-medium text-[var(--foreground-muted)] px-2 py-0.5 rounded-full border border-[var(--border-color)]">
                    {tech}
                  </span>
                ))}
              </div>
            </a>
          ))
        }
      </div>
    </section>

    <!-- Contact -->
    <section id="contact" class="text-center py-14 scroll-reveal">
      <span class="section-heading mb-4 inline-block">Contact</span>
      <h2
        class="text-[24px] md:text-[28px] font-extrabold mb-2 tracking-[-0.01em]"
      >
        let's connect
      </h2>
      <p
        class="text-[13px] text-[var(--foreground-muted)] mb-8 max-w-xs mx-auto leading-[1.7]"
      >
        Always open to discussing testing, automation, or opportunities to grow
        together.
      </p>

      <div class="flex justify-center gap-3 mb-6">
        <a
          href={site.github}
          target="_blank"
          rel="noopener noreferrer"
          class="social-ghost"
          aria-label="GitHub"
        >
          <Fragment set:html={icons.github} />
        </a>
        <a
          href={site.linkedin}
          target="_blank"
          rel="noopener noreferrer"
          class="social-ghost"
          aria-label="LinkedIn"
        >
          <Fragment set:html={icons.linkedin} />
        </a>
        <a
          href="https://twitter.com/theodores"
          target="_blank"
          rel="noopener noreferrer"
          class="social-ghost"
          aria-label="Twitter / X"
        >
          <Fragment set:html={icons.twitter} />
        </a>
      </div>

      <a href={`mailto:${site.email}`} class="cta-primary">
        Get in Touch
        <Fragment set:html={icons.arrow} />
      </a>
    </section>

    <!-- Footer -->
    <footer class="py-8 text-center">
      <div class="section-divider mb-6"></div>
      <p
        class="text-[10px] text-[var(--foreground-muted)] tracking-[0.08em] uppercase"
      >
        © {new Date().getFullYear()}
        {site.author} · Built with Astro
      </p>
    </footer>
  </main>

  <script>
    const themeToggle = document.getElementById("theme-toggle");
    const html = document.documentElement;
    const savedTheme = localStorage.getItem("theme");
    const systemTheme = window.matchMedia("(prefers-color-scheme: dark)")
      .matches
      ? "dark"
      : "light";
    if ((savedTheme || systemTheme) === "dark") html.classList.add("dark");

    themeToggle?.addEventListener("click", () => {
      html.classList.toggle("dark");
      localStorage.setItem(
        "theme",
        html.classList.contains("dark") ? "dark" : "light"
      );
    });

    const dock = document.getElementById("floating-dock");
    const handleDockVisibility = () => {
      dock?.classList.toggle("visible", window.scrollY > 100);
    };
    window.addEventListener("scroll", handleDockVisibility, { passive: true });
    handleDockVisibility();

    const progressBar = document.getElementById("scroll-progress");
    window.addEventListener(
      "scroll",
      () => {
        const h = document.documentElement.scrollHeight - window.innerHeight;
        if (progressBar)
          progressBar.style.width = `${
            h > 0 ? (window.scrollY / h) * 100 : 0
          }%`;
      },
      { passive: true }
    );

    const sections = document.querySelectorAll("section[id]");
    const dockBtns = document.querySelectorAll(
      ".dock-btn[data-section]"
    ) as NodeListOf<HTMLElement>;
    window.addEventListener(
      "scroll",
      () => {
        let cur = "hero";
        sections.forEach((s) => {
          if (s.getBoundingClientRect().top <= window.innerHeight * 0.4)
            cur = s.id;
        });
        dockBtns.forEach((b) =>
          b.classList.toggle("active", b.dataset.section === cur)
        );
      },
      { passive: true }
    );

    const reveals = document.querySelectorAll(".scroll-reveal");
    const obs = new IntersectionObserver(
      (entries) => {
        entries.forEach((e) => {
          if (e.isIntersecting) {
            e.target.classList.add("visible");
            obs.unobserve(e.target);
          }
        });
      },
      { threshold: 0.08, rootMargin: "0px 0px -30px 0px" }
    );
    reveals.forEach((el) => obs.observe(el));

    const cursor = document.getElementById("custom-cursor");
    if (
      cursor &&
      !window.matchMedia("(prefers-reduced-motion: reduce)").matches &&
      window.innerWidth > 768
    ) {
      let cx = 0,
        cy = 0,
        px = 0,
        py = 0;
      document.addEventListener("mousemove", (e) => {
        cx = e.clientX;
        cy = e.clientY;
        cursor.classList.add("visible");
      });
      const tick = () => {
        px += (cx - px) * 0.15;
        py += (cy - py) * 0.15;
        cursor.style.left = `${px}px`;
        cursor.style.top = `${py}px`;
        requestAnimationFrame(tick);
      };
      tick();
      document.addEventListener("mouseleave", () =>
        cursor.classList.remove("visible")
      );
      document
        .querySelectorAll(
          "a, button, .skill-tag, .bento-cell, .social-ghost, .project-card"
        )
        .forEach((el) => {
          el.addEventListener("mouseenter", () =>
            cursor.classList.add("hover")
          );
          el.addEventListener("mouseleave", () =>
            cursor.classList.remove("hover")
          );
        });
    }
  </script>
</Layout>
